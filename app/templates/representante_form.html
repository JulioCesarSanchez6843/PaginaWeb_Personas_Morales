{% extends 'layout.html' %}

{% block content %}
<h2>{{ 'Editar Representante' if representante else 'Nuevo Representante' }}</h2>

{# Mostrar mensajes flash #}
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div>
      {% for category, message in messages %}
        <div class="alert alert-{{ 'danger' if category == 'danger' or category == 'warning' else category }}" role="alert">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<form method="POST"
      action="{% if representante and representante.get('id_representante') %}{{ url_for('representantes_legales_view.editar_representante', id=representante['id_representante']) }}{% else %}{{ url_for('representantes_legales_view.nuevo_representante') }}{% endif %}">

    {% if representante and representante.get('id_representante') %}
    <input type="hidden" name="id_representante" value="{{ representante['id_representante'] }}">
    {% endif %}

    <div class="form-group">
        <label for="id_moral">Persona Moral</label>
        <select id="id_moral" name="id_moral" class="form-control" required>
            <option value="">Seleccione...</option>
            {% for moral in personas_morales %}
            <option value="{{ moral.id }}" {% if representante and representante.get('id_moral') == moral.id %}selected{% endif %}>
                {{ moral.razon_social }}
            </option>
            {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label for="nombre">Nombre(s)</label>
        <input type="text" id="nombre" name="nombre" class="form-control" required value="{{ representante['nombre'] if representante else '' }}">
    </div>

    <div class="form-group">
        <label for="apellido_paterno">Apellido Paterno</label>
        <input type="text" id="apellido_paterno" name="apellido_paterno" class="form-control" value="{{ representante['apellido_paterno'] if representante else '' }}">
    </div>

    <div class="form-group">
        <label for="apellido_materno">Apellido Materno</label>
        <input type="text" id="apellido_materno" name="apellido_materno" class="form-control" value="{{ representante['apellido_materno'] if representante else '' }}">
    </div>

    <div class="form-group">
        <label for="curp">CURP</label>
        <input type="text" id="curp" name="curp" class="form-control" value="{{ representante['curp'] if representante else '' }}">
    </div>

    <div class="form-group">
        <label for="rfc">RFC</label>
        <input type="text" id="rfc" name="rfc" class="form-control" value="{{ representante['rfc'] if representante else '' }}">
    </div>

    <div class="form-group">
        <label for="telefono">Teléfono</label>
        <input type="text" id="telefono" name="telefono" class="form-control" value="{{ representante['telefono'] if representante else '' }}">
    </div>

    <div class="form-group">
        <label for="email">Correo electrónico</label>
        <input type="email" id="email" name="email" class="form-control" value="{{ representante['email'] if representante else '' }}">
    </div>

    <div class="form-group">
        <label for="fecha_nacimiento">Fecha de nacimiento</label>
        <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" class="form-control" value="{{ representante['fecha_nacimiento'] if representante else '' }}">
    </div>

    <!-- Aquí ELIMINAMOS el campo Estado -->

    <button type="submit" class="btn btn-primary">{{ 'Actualizar' if representante else 'Guardar' }}</button>
    <a href="{{ url_for('representantes_legales_view.listar_representantes') }}" class="btn btn-secondary">Cancelar</a>
</form>
{% endblock %}
